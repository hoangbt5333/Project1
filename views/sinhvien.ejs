<div class="space-y-6">
  <!-- TIÊU ĐỀ & ACTIONS -->
  <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3">
    <div>
      <p class="text-xs uppercase tracking-[0.3em] text-slate-400 font-semibold">Sinh viên</p>
      <h2 class="text-2xl font-bold text-slate-800">Danh sách sinh viên</h2>
    </div>

    <div class="flex flex-wrap gap-3 items-center">

      <!-- Nút thêm sinh viên -->
      <a href="/sinhvien/add"
        class="inline-flex items-center gap-2 px-4 py-2 bg-brand text-white rounded-xl font-semibold hover:bg-brand-soft transition">
        <i class="fa-solid fa-plus"></i> Thêm sinh viên
      </a>

      <!-- Nhóm Import / Export (compact) -->
      <div class="flex items-center gap-2 bg-white border border-slate-200 rounded-full px-3 py-1 shadow-sm">
        <!-- Import form: hidden input + label button -->
        <form action="/sinhvien/import" method="POST" enctype="multipart/form-data" class="flex items-center gap-2 m-0 p-0">
          <input id="excelFileInput" name="excelFile" type="file" accept=".xlsx,.xls" class="hidden" onchange="this.form.submit()" />
          <label for="excelFileInput"
            class="inline-flex items-center gap-2 px-3 py-2 text-sm font-semibold text-emerald-700 bg-emerald-50 rounded-lg hover:bg-emerald-100 cursor-pointer transition">
            <i class="fa-solid fa-file-import mr-1"></i> Nhập
          </label>
        </form>

        <form action="/sinhvien/export" method="GET" class="m-0 p-0">
          <button type="submit"
            class="inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-200 text-sm font-semibold text-slate-700 hover:bg-slate-50 transition">
            <i class="fa-solid fa-file-export mr-1"></i> Xuất
          </button>
        </form>
      </div>
    </div>
  </div>

  <!-- TOAST (fixed, does not affect layout) -->
  <% if (message) { %>
    <div id="toast-message"
         class="fixed top-6 right-6 z-50 max-w-xs px-4 py-3 rounded-lg shadow-lg text-sm bg-emerald-600 text-white flex items-center gap-3"
         role="status" aria-live="polite">
      <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293A1 1 0 006.293 10.707l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>
      <div class="flex-1"><%= message %></div>
      <button id="toast-close" class="text-white opacity-90 hover:opacity-100 focus:outline-none">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>

    <script>
      (function(){
        const toast = document.getElementById('toast-message');
        const closeBtn = document.getElementById('toast-close');
        if (!toast) return;
        // auto close after 3s with fade
        setTimeout(() => {
          toast.style.transition = 'opacity 300ms ease, transform 300ms ease';
          toast.style.opacity = '0';
          toast.style.transform = 'translateY(-8px)';
          setTimeout(() => toast.remove(), 350);
        }, 3000);
        closeBtn && closeBtn.addEventListener('click', () => toast.remove());
      })();
    </script>
  <% } %>

  <!-- KHUNG BẢNG -->
  <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-5 space-y-4">

    <!-- TÌM KIẾM -->
    <form action="/sinhvien" method="GET" class="flex flex-col md:flex-row gap-3 items-center">
      <div class="relative flex-1">
        <i class="fa fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
        <input type="text" name="search" placeholder="Tìm kiếm mã SV hoặc họ tên..."
          value="<%= keyword || '' %>"
          class="w-full pl-10 pr-4 py-3 border border-slate-200 rounded-xl bg-slate-50 focus:ring-2 focus:ring-brand focus:border-brand">
      </div>

      <button
        class="px-5 py-3 bg-brand text-white font-semibold rounded-xl hover:bg-brand-soft transition whitespace-nowrap">
        Tìm kiếm
      </button>
    </form>

    <!-- BẢNG DỮ LIỆU -->
    <div class="overflow-x-auto table-scroll">
      <table class="min-w-full text-left text-sm text-slate-700">
        <thead class="table-head sticky top-0 z-20">
          <tr class="bg-slate-50 text-xs uppercase text-slate-500 border-b border-slate-200">
            <th class="sticky top-0 z-20 px-4 py-3">STT</th>
            <th class="sticky top-0 z-20 px-4 py-3">MSSV</th>
            <th class="sticky top-0 z-20 px-4 py-3">Họ tên</th>
            <th class="sticky top-0 z-20 px-4 py-3">Lớp</th>
            <th class="sticky top-0 z-20 px-4 py-3">Thao tác</th>
          </tr>
        </thead>

        <tbody>
          <% students.forEach((student, i) => { %>
            <tr class="odd:bg-white even:bg-slate-100 hover:bg-gray-100 transition">
              <td class="px-4 py-3"><%= i + 1 %></td>

              <td class="px-4 py-3 font-semibold text-slate-800">
                <%= student.ma_sv %>
              </td>

              <td class="px-4 py-3"><%= student.ho_ten %></td>

              <td class="px-4 py-3"><%= student.ten_lop %></td>

              <td class="px-4 py-3">
                <div class="flex items-center gap-2">

                  <a href="/sinhvien/view/<%= student.ma_sv %>"
                    class="w-8 h-8 flex items-center justify-center bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition"
                    title="Xem chi tiết">
                    <i class="fa-solid fa-search"></i>
                  </a>

                  <a href="/sinhvien/edit/<%= student.ma_sv %>"
                    class="w-8 h-8 flex items-center justify-center bg-amber-50 text-amber-700 rounded-lg hover:bg-amber-100 transition"
                    title="Chỉnh sửa">
                    <i class="fa-solid fa-pen"></i>
                  </a>

                  <form action="/sinhvien/delete/<%= student.ma_sv %>" method="POST"
                    onsubmit="return confirm('Bạn có chắc chắn muốn xóa sinh viên này?');">
                    <button type="submit"
                      class="w-8 h-8 flex items-center justify-center bg-rose-50 text-rose-700 rounded-lg hover:bg-rose-100 transition"
                      title="Xóa">
                      <i class="fa-solid fa-trash"></i>
                    </button>
                  </form>

                </div>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>
</div>
